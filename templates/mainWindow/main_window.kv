#:kivy 1.0

#: import Factory kivy.factory.Factory

#:set colorUVG (0,141/255,54/255,1)
#:set backgroundGeneral (204/255, 204/255, 204/255, 1)
<MensajeCelularUsuario>:
    size_hint: [None, None]
    width: root.ancho
    height: root.altura
    pos_hint: {"right": 0.98}
    text: root.texto
    font_size: 20
    background_normal: ''
    background_down: ''
    background_color: (0, 0, 0, 0)
    canvas.before:
        Color:
            rgba: colorUVG
        RoundedRectangle:
            size: self.size
            pos: self.pos     


<MensajeCelularChatbot>:
    size_hint: [None, None]
    width: root.ancho
    height: root.altura
    pos_hint: {"left": 0.3}
    text: root.texto
    font_size: 20
    background_normal: ''
    background_down: ''
    background_color: (0, 0, 0, 0)
    canvas.before:
        Color:
            rgba: (0/255, 168/255, 243/255, 1)
        RoundedRectangle:
            size: self.size
            pos: self.pos


<CountDown>:



<MainWindow>:
    name: "main"
    GridLayout:
        cols: 3
        canvas.before:
            Color:
                rgba: backgroundGeneral
            Rectangle:
                size: self.size
                pos: self.pos
        BoxLayout:
            orientation: "vertical"
            
            BoxLayout:
                orientation:"vertical"
                size_hint: [1, None]
                height: 500
                Image:
                    id: vid
                    size_hint: [.95, .95]
                    allow_stretch: True  # allow the video image to be scaled
                    keep_ratio: True  # keep the aspect ratio so people don't look squashed
                    pos_hint: {"center_x":0.5, "center_y":0.5}
            BoxLayout:
                orientation:'horizontal'
                Label:
                    text: 'FOTO TOMADA'
                    font_size: 30
                Label:
                    text: 'EMOJI REPRESENTATIVO'
                    font_size: 30
            BoxLayout:
                orientation:'horizontal'
                Label:
                    text:""
                    size_hint: [None, 1]
                    width: 10
                Button:
                    text: '  TOMATE \n      UNA \n     FOTO'
                    font_size: 30
                    bold: True
                    color: (1, 1, 1, 1)
                    size_hint: [None, None]
                    height: 210
                    width: 210
                    pos_hint: {'center_x':.5, 'center_y':.5}
                    background_normal: ''
                    background_down: ''
                    background_color: (0, 0, 0, 0)
                    rounded_background: (0,141/255,54/255,1)
                    canvas.before:
                        Color:
                            rgba: self.rounded_background
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
                            radius: [130]
                    on_press: 
                        self.rounded_background = (0/255, 117/255, 45/255, 1)
                    on_release: 
                        root.start()
                        self.rounded_background = (0,141/255,54/255,1)
                Label:
                    id: countdown_label
                    text: ""
                    font_size: 150
                    bold: True
                    outline_color: (0,141/255,54/255)
                    outline_width: 5
                
        BoxLayout:
            orientation: "vertical"
            padding: [0, 30]
            spacing: 75
            Image:
                source: 'templates/mainWindow/imagenes/logo001.png'
                allow_stretch: True
                size_hint: [None, None]
                size: [400, 400]
                pos_hint: {'center_x':.5, 'center_y':.5}
            BoxLayout:
                Image:
                    source: 'templates/mainWindow/imagenes/red_neuronal.png'
                    keep_ratio: True
                    size_hint: [1, None]
                    height: 200
                    pos_hint: {'center_x':.5, 'center_y':.5}
                BoxLayout:
                    orientation:"vertical"

                    Label:
                        id: nombre_inteligencia
                        text: "RED NEURONAL"
                        font_size: 25
                        bold: True
                        pos_hint: {'center_y': 200}
                    Button:
                        id: inteligencia
                        background_normal: ''
                        background_down: ''
                        background_color: backgroundGeneral
                        size_hint: [None, None]
                        size: [110, 110]
                        pos_hint: {'center_x':0.5,'center_y': 0.5}
                        image_source: 'templates/mainWindow/imagenes/switch_izquierda.png'
                        on_press: root.cambio_inteligencia()
                        Image: 
                            source: self.parent.image_source
                            center_x: self.parent.center_x
                            center_y: self.parent.center_y
                    Label:
                        text: ""
                Image:
                    source: 'templates/mainWindow/imagenes/inteligencia_artificial.png'
                    keep_ratio: True
                    size_hint: [1, None]
                    height: 200
                    pos_hint: {'center_x':.5, 'center_y':.5}
            Label:
                text: ""
        BoxLayout:
            orientation: "vertical"

            BoxLayout:
                orientation:"horizontal"
                size_hint: [1, 0.3]
                spacing: 50
                padding: [30, 0]
                Button:
                    text: '       HABLALE \n              AL \nANIMATRÃ“NICO'
                    font_size: 30
                    bold: True
                    color: (1, 1, 1, 1)
                    size_hint: [None, None]
                    height: 270
                    width: 270
                    pos_hint: {'center_x':.5, 'center_y':.5}
                    background_normal: ''
                    background_down: ''
                    background_color: (0, 0, 0, 0)
                    rounded_background: (0,141/255,54/255,1)
                    canvas.before:
                        Color:
                            rgba: self.rounded_background
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
                            radius: [150]
                    on_press: 
                        self.rounded_background = (234/255, 0/255, 0/255, 1)
                        root.ids.chatbot_estado.source = 'templates/mainWindow/imagenes/persona_escuchando.png'
                        root.escuchando()
                    on_release: 
                        root.finalizar_escuchar()
                        root.ids.chatbot_estado.source = 'templates/mainWindow/imagenes/persona_hablando.png'
                        self.rounded_background = (0,141/255,54/255,1)
                Image:
                    id: chatbot_estado
                    source: 'templates/mainWindow/imagenes/robot_neutral.png'
                    size_hint: [None, None]
                    width: 270
                    height: 270
                    pos_hint: {'center_x':.5, 'center_y':.5}
            BoxLayout:
                orientation: "vertical"
                size_hint: [1, 0.7]
                canvas.before:
                    Color:
                        rgba: (1, 1, 1, 1)
                    Rectangle:
                        source: 'templates/mainWindow/imagenes/celular.png'
                        size: [self.width-50, self.height]
                        pos: [self.pos[0]+50, self.pos[1]]
                Label:
                    text: ''
                    size_hint: [1, None]
                    height: 95
                ScrollView:
                    id: scrollview_celular
                    do_scroll_y: True
                    do_scroll_x: False
                    size_hint: [.83, 1]
                    pos_hint: {"center_x": .54, "center_y": .5}
                    padding: [5, 25]
                    BoxLayout:
                        orientation:"vertical"
                        size_hint: [1, None]
                        height: self.minimum_height
                        id: celular
                        spacing: 30
                        padding: [0, 30]
                        Label:
                            text: ''
                            size_hint: [1, None]
                            height: 50
                Label:
                    text: ''
                    size_hint: [1, None]
                    height: 92
            # Menu entre pantallas
            FloatLayout:
                size_hint: [None, 0.00001]
                BoxLayout:
                    pos: [Factory.MotorWindow().menu_pos()+75, 15]
                    orientation: "horizontal"
                    size_hint: [None,None]
                    width: 160
                    height: 70
                    background_color: (128/255, 128/255, 128/255, .5)
                    canvas.before:
                        Color:
                            rgba: self.background_color
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
                            radius: [15]

                    Label:
                        text:""
                        size_hint: [0.1,1]
                    Button:
                        background_normal: ''
                        background_down: ''
                        background_color: backgroundGeneral
                        size_hint: [None, None]
                        size: [54, 54]
                        pos_hint: {'center_x':0.5,'center_y': 0.5}
                        image_source: 'templates/motorWindow/imagenes/menu/settings_v2.png'
                        on_press: 
                            self.image_source = 'templates/motorWindow/imagenes/menu/settings_v2_press.png'
                        on_release: 
                            self.image_source = 'templates/motorWindow/imagenes/menu/settings_v2.png'
                            Factory.SettingWindow().open()
                        Image: 
                            source: self.parent.image_source
                            center_x: self.parent.center_x
                            center_y: self.parent.center_y
                            size: [60, 60]
                    Label:
                        text:""
                        size_hint: [0.2,1]
                    Button:
                        background_normal: ''
                        background_down: ''
                        background_color: backgroundGeneral
                        size_hint: [None, None]
                        size: [48, 48]
                        pos_hint: {'center_x':0.5,'center_y': 0.5}
                        image_source: 'templates/motorWindow/imagenes/menu/flecha-derecha.png'
                        on_press: 
                            self.image_source = 'templates/motorWindow/imagenes/menu/flecha-derecha-press.png'
                        on_release: 
                            self.image_source = 'templates/motorWindow/imagenes/menu/flecha-derecha.png'
                            root.manager.transition.direction = "left"
                            app.root.current = "motor"
                        Image: 
                            source: self.parent.image_source
                            center_x: self.parent.center_x
                            center_y: self.parent.center_y
                            size: [60, 60] 
                    Label:
                        text:""
                        size_hint: [0.1,1]
